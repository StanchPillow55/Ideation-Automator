'use client'; import React,{useEffect,useState} from 'react'; import {Button} from '../../components/ui/button'; import {Input} from '../../components/ui/input';
const API=process.env.NEXT_PUBLIC_API_URL||'http://localhost:8000'; type Doc={id:string;source_type:string;url_or_path?:string};
export default function Sources(){const[t,setT]=useState('web');const[u,setU]=useState('');const[f,setF]=useState<File|null>(null);const[D,setD]=useState<Doc[]>([]);
const load=async()=>{const r=await fetch(`${API}/v1/sources`);setD(await r.json());}; useEffect(()=>{load();},[]);
const submit=async(e:React.FormEvent)=>{e.preventDefault();const form=new FormData();form.append('source_type',t);if(f)form.append('file',f);if(u)form.append('url',u);const r=await fetch(`${API}/v1/sources`,{method:'POST',body:form});if(r.ok){setU('');setF(null);load();}else alert('Failed');};
return(<div className="card"><h2 className="text-xl font-semibold mb-4">Add Source</h2><form onSubmit={submit} className="space-y-3"><div><label className="block text-sm">Source Type</label><select className="input" value={t} onChange={e=>setT(e.target.value)}><option>web</option><option>youtube</option><option>pdf</option><option>docx</option><option>pptx</option><option>audio</option><option>instagram</option></select></div><div><label className="block text-sm">URL</label><Input value={u} onChange={e=>setU(e.target.value)} placeholder="https://example.com or file path" /></div><div><label className="block text-sm">Upload</label><input type="file" onChange={e=>setF(e.target.files?.[0]||null)} /></div><Button type="submit">Create Source</Button></form><h3 className="text-lg font-semibold mt-6">Recent Sources</h3><ul className="mt-2 space-y-1">{D.map(d=>(<li key={d.id} className="text-sm">{d.id} · {d.source_type} · {d.url_or_path||''}</li>))}</ul></div>);} 
